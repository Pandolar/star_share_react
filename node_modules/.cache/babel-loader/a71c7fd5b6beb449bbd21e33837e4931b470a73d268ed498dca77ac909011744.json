{"ast":null,"code":"/**\n * 认证管理组件\n * 用于设置和管理用户的认证信息\n */import React,{useState,useEffect}from'react';import{Card,CardBody,Button,Input,Chip}from'@heroui/react';import{motion}from'framer-motion';import{Key,User,CheckCircle,AlertCircle}from'lucide-react';import{userAuthApi}from'../services/userApi';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export const AuthManager=_ref=>{var _localStorage$getItem;let{onAuthChange}=_ref;const[xuserid,setXuserid]=useState('');const[xtoken,setXtoken]=useState('');const[isAuthenticated,setIsAuthenticated]=useState(false);// 检查当前认证状态\nconst checkAuthStatus=()=>{const authenticated=userAuthApi.isAuthenticated();setIsAuthenticated(authenticated);onAuthChange===null||onAuthChange===void 0?void 0:onAuthChange(authenticated);if(authenticated){const currentUserid=localStorage.getItem('xuserid')||'';const currentToken=localStorage.getItem('xtoken')||'';setXuserid(currentUserid);setXtoken(currentToken);}};// 设置认证信息\nconst handleSetAuth=()=>{if(xuserid.trim()&&xtoken.trim()){userAuthApi.setAuth(xuserid.trim(),xtoken.trim());checkAuthStatus();}};// 清除认证信息\nconst handleClearAuth=()=>{userAuthApi.clearAuth();setXuserid('');setXtoken('');checkAuthStatus();};// 使用示例认证信息\nconst handleUseExample=()=>{setXuserid('2');setXtoken('f5a21305-29d3-4146-862e-420a01446d63');};useEffect(()=>{checkAuthStatus();},[]);return/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:\"mb-6\",children:/*#__PURE__*/_jsx(Card,{className:`border-l-4 ${isAuthenticated?'border-l-success':'border-l-warning'}`,children:/*#__PURE__*/_jsx(CardBody,{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-3\",children:isAuthenticated?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CheckCircle,{size:20,className:\"text-success\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-success font-medium\",children:\"\\u5DF2\\u8BA4\\u8BC1\"}),/*#__PURE__*/_jsx(Chip,{size:\"sm\",color:\"success\",variant:\"flat\",children:\"\\u5DF2\\u767B\\u5F55\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AlertCircle,{size:20,className:\"text-warning\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-warning font-medium\",children:\"\\u672A\\u8BA4\\u8BC1\"}),/*#__PURE__*/_jsx(Chip,{size:\"sm\",color:\"warning\",variant:\"flat\",children:\"\\u8BF7\\u8BBE\\u7F6E\\u8BA4\\u8BC1\\u4FE1\\u606F\"})]})}),!isAuthenticated&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(Input,{label:\"\\u7528\\u6237ID (xuserid)\",placeholder:\"\\u8BF7\\u8F93\\u5165\\u7528\\u6237ID\",value:xuserid,onValueChange:setXuserid,startContent:/*#__PURE__*/_jsx(User,{size:16}),variant:\"bordered\"}),/*#__PURE__*/_jsx(Input,{label:\"\\u8BA4\\u8BC1\\u4EE4\\u724C (xtoken)\",placeholder:\"\\u8BF7\\u8F93\\u5165\\u8BA4\\u8BC1\\u4EE4\\u724C\",value:xtoken,onValueChange:setXtoken,startContent:/*#__PURE__*/_jsx(Key,{size:16}),variant:\"bordered\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(Button,{color:\"primary\",onPress:handleSetAuth,isDisabled:!xuserid.trim()||!xtoken.trim(),children:\"\\u8BBE\\u7F6E\\u8BA4\\u8BC1\"}),/*#__PURE__*/_jsx(Button,{variant:\"bordered\",onPress:handleUseExample,children:\"\\u4F7F\\u7528\\u793A\\u4F8B\"})]})]}),isAuthenticated&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-default-50 p-3 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-default-500\",children:\"\\u7528\\u6237ID: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:localStorage.getItem('xuserid')})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-default-500\",children:\"\\u4EE4\\u724C: \"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium font-mono text-xs\",children:[(_localStorage$getItem=localStorage.getItem('xtoken'))===null||_localStorage$getItem===void 0?void 0:_localStorage$getItem.substring(0,20),\"...\"]})]})]})}),/*#__PURE__*/_jsx(Button,{color:\"danger\",variant:\"light\",size:\"sm\",onPress:handleClearAuth,children:\"\\u6E05\\u9664\\u8BA4\\u8BC1\\u4FE1\\u606F\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-default-500 border-t pt-3\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u8BF7\\u8BBE\\u7F6E\\u6B63\\u786E\\u7684\\u7528\\u6237ID\\u548C\\u8BA4\\u8BC1\\u4EE4\\u724C\\u4EE5\\u8BBF\\u95EEAPI\\u63A5\\u53E3\\u3002\\u8BA4\\u8BC1\\u4FE1\\u606F\\u5C06\\u5B58\\u50A8\\u5728\\u6D4F\\u89C8\\u5668\\u7684localStorage\\u4E2D\\u3002\"})})]})})})});};","map":{"version":3,"names":["React","useState","useEffect","Card","CardBody","Button","Input","Chip","motion","Key","User","CheckCircle","AlertCircle","userAuthApi","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","AuthManager","_ref","_localStorage$getItem","onAuthChange","xuserid","setXuserid","xtoken","setXtoken","isAuthenticated","setIsAuthenticated","checkAuthStatus","authenticated","currentUserid","localStorage","getItem","currentToken","handleSetAuth","trim","setAuth","handleClearAuth","clearAuth","handleUseExample","div","initial","opacity","y","animate","className","children","size","color","variant","label","placeholder","value","onValueChange","startContent","onPress","isDisabled","substring"],"sources":["/opt/dev/star_share/web/src/components/AuthManager.tsx"],"sourcesContent":["/**\n * 认证管理组件\n * 用于设置和管理用户的认证信息\n */\nimport React, { useState, useEffect } from 'react';\nimport { Card, CardBody, Button, Input, Chip } from '@heroui/react';\nimport { motion } from 'framer-motion';\nimport { Key, User, CheckCircle, AlertCircle } from 'lucide-react';\nimport { userAuthApi } from '../services/userApi';\n\ninterface AuthManagerProps {\n  onAuthChange?: (isAuthenticated: boolean) => void;\n}\n\nexport const AuthManager: React.FC<AuthManagerProps> = ({ onAuthChange }) => {\n  const [xuserid, setXuserid] = useState<string>('');\n  const [xtoken, setXtoken] = useState<string>('');\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean>(false);\n\n  // 检查当前认证状态\n  const checkAuthStatus = () => {\n    const authenticated = userAuthApi.isAuthenticated();\n    setIsAuthenticated(authenticated);\n    onAuthChange?.(authenticated);\n\n    if (authenticated) {\n      const currentUserid = localStorage.getItem('xuserid') || '';\n      const currentToken = localStorage.getItem('xtoken') || '';\n      setXuserid(currentUserid);\n      setXtoken(currentToken);\n    }\n  };\n\n  // 设置认证信息\n  const handleSetAuth = () => {\n    if (xuserid.trim() && xtoken.trim()) {\n      userAuthApi.setAuth(xuserid.trim(), xtoken.trim());\n      checkAuthStatus();\n    }\n  };\n\n  // 清除认证信息\n  const handleClearAuth = () => {\n    userAuthApi.clearAuth();\n    setXuserid('');\n    setXtoken('');\n    checkAuthStatus();\n  };\n\n  // 使用示例认证信息\n  const handleUseExample = () => {\n    setXuserid('2');\n    setXtoken('f5a21305-29d3-4146-862e-420a01446d63');\n  };\n\n  useEffect(() => {\n    checkAuthStatus();\n  }, []);\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: -20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"mb-6\"\n    >\n      <Card className={`border-l-4 ${isAuthenticated ? 'border-l-success' : 'border-l-warning'}`}>\n        <CardBody className=\"p-6\">\n          <div className=\"space-y-4\">\n            {/* 状态显示 */}\n            <div className=\"flex items-center gap-3\">\n              {isAuthenticated ? (\n                <>\n                  <CheckCircle size={20} className=\"text-success\" />\n                  <span className=\"text-success font-medium\">已认证</span>\n                  <Chip size=\"sm\" color=\"success\" variant=\"flat\">已登录</Chip>\n                </>\n              ) : (\n                <>\n                  <AlertCircle size={20} className=\"text-warning\" />\n                  <span className=\"text-warning font-medium\">未认证</span>\n                  <Chip size=\"sm\" color=\"warning\" variant=\"flat\">请设置认证信息</Chip>\n                </>\n              )}\n            </div>\n\n            {/* 认证信息输入 */}\n            {!isAuthenticated && (\n              <div className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <Input\n                    label=\"用户ID (xuserid)\"\n                    placeholder=\"请输入用户ID\"\n                    value={xuserid}\n                    onValueChange={setXuserid}\n                    startContent={<User size={16} />}\n                    variant=\"bordered\"\n                  />\n                  <Input\n                    label=\"认证令牌 (xtoken)\"\n                    placeholder=\"请输入认证令牌\"\n                    value={xtoken}\n                    onValueChange={setXtoken}\n                    startContent={<Key size={16} />}\n                    variant=\"bordered\"\n                  />\n                </div>\n\n                <div className=\"flex gap-2\">\n                  <Button\n                    color=\"primary\"\n                    onPress={handleSetAuth}\n                    isDisabled={!xuserid.trim() || !xtoken.trim()}\n                  >\n                    设置认证\n                  </Button>\n                  <Button\n                    variant=\"bordered\"\n                    onPress={handleUseExample}\n                  >\n                    使用示例\n                  </Button>\n                </div>\n              </div>\n            )}\n\n            {/* 已认证状态下的信息 */}\n            {isAuthenticated && (\n              <div className=\"space-y-3\">\n                <div className=\"bg-default-50 p-3 rounded-lg\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm\">\n                    <div>\n                      <span className=\"text-default-500\">用户ID: </span>\n                      <span className=\"font-medium\">{localStorage.getItem('xuserid')}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-default-500\">令牌: </span>\n                      <span className=\"font-medium font-mono text-xs\">\n                        {localStorage.getItem('xtoken')?.substring(0, 20)}...\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                <Button\n                  color=\"danger\"\n                  variant=\"light\"\n                  size=\"sm\"\n                  onPress={handleClearAuth}\n                >\n                  清除认证信息\n                </Button>\n              </div>\n            )}\n\n            {/* 说明 */}\n            <div className=\"text-xs text-default-500 border-t pt-3\">\n              <p>请设置正确的用户ID和认证令牌以访问API接口。认证信息将存储在浏览器的localStorage中。</p>\n            </div>\n          </div>\n        </CardBody>\n      </Card>\n    </motion.div>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}