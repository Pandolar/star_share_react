{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,CardBody,Input,Button,Spinner}from'@heroui/react';import{Lock,User}from'lucide-react';import{useNavigate}from'react-router-dom';import{authApi}from'../../services/api';import{isAuthenticated,setStoredToken}from'../../config';import{showMessage}from'../../utils/toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminLogin=()=>{const[loading,setLoading]=useState(false);const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[errors,setErrors]=useState({});const navigate=useNavigate();// 如果已经登录，直接跳转到管理页面\nuseEffect(()=>{if(isAuthenticated()){navigate('/admin',{replace:true});}},[navigate]);// 表单验证\nconst validateForm=()=>{const newErrors={};if(!username||username.length<3){newErrors.username=username?'用户名至少3个字符':'请输入用户名';}if(!password||password.length<6){newErrors.password=password?'密码至少6个字符':'请输入密码';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}setLoading(true);try{var _response$data;const response=await authApi.login(username,password);if(response.code===20000&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.admin_token){setStoredToken(response.data.admin_token);showMessage.success('登录成功');navigate('/admin',{replace:true});}else{showMessage.error(response.msg||'登录失败');}}catch(error){showMessage.error(error instanceof Error?error.message:'登录失败');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\",children:/*#__PURE__*/_jsx(Card,{className:\"w-full max-w-md shadow-2xl\",children:/*#__PURE__*/_jsxs(CardBody,{className:\"p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-800 mb-2\",children:\"\\u7BA1\\u7406\\u540E\\u53F0\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Star Share Admin\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 text-sm font-medium text-gray-700\",children:\"\\u7528\\u6237\\u540D\"}),/*#__PURE__*/_jsx(Input,{value:username,onChange:e=>setUsername(e.target.value),placeholder:\"\\u8BF7\\u8F93\\u5165\\u7528\\u6237\\u540D\",size:\"lg\",startContent:/*#__PURE__*/_jsx(User,{size:18,color:\"#9ca3af\"}),autoComplete:\"username\",isInvalid:!!errors.username,errorMessage:errors.username})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 text-sm font-medium text-gray-700\",children:\"\\u5BC6\\u7801\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),placeholder:\"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",size:\"lg\",startContent:/*#__PURE__*/_jsx(Lock,{size:18,color:\"#9ca3af\"}),autoComplete:\"current-password\",isInvalid:!!errors.password,errorMessage:errors.password})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",size:\"lg\",isLoading:loading,disabled:loading,className:\"w-full h-12 text-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 transition-colors\",color:\"primary\",children:loading?/*#__PURE__*/_jsx(Spinner,{size:\"sm\",color:\"white\"}):'登录'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 text-center text-xs text-gray-500\",children:\"\\xA9 2024 Star Share. All rights reserved.\"})]})})});};export default AdminLogin;","map":{"version":3,"names":["React","useState","useEffect","Card","CardBody","Input","Button","Spinner","Lock","User","useNavigate","authApi","isAuthenticated","setStoredToken","showMessage","jsx","_jsx","jsxs","_jsxs","AdminLogin","loading","setLoading","username","setUsername","password","setPassword","errors","setErrors","navigate","replace","validateForm","newErrors","length","Object","keys","handleSubmit","e","preventDefault","_response$data","response","login","code","data","admin_token","success","error","msg","Error","message","className","children","onSubmit","value","onChange","target","placeholder","size","startContent","color","autoComplete","isInvalid","errorMessage","type","isLoading","disabled"],"sources":["/opt/dev/star_share/web/src/pages/admin/AdminLogin.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Card, CardBody, Input, Button, Spinner } from '@heroui/react';\nimport { Lock, User } from 'lucide-react';\nimport { useNavigate } from 'react-router-dom';\nimport { authApi } from '../../services/api';\nimport { isAuthenticated, setStoredToken } from '../../config';\n\nimport { showMessage } from '../../utils/toast';\n\nconst AdminLogin: React.FC = () => {\n  const [loading, setLoading] = useState(false);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errors, setErrors] = useState<{username?: string; password?: string}>({});\n  const navigate = useNavigate();\n\n  // 如果已经登录，直接跳转到管理页面\n  useEffect(() => {\n    if (isAuthenticated()) {\n      navigate('/admin', { replace: true });\n    }\n  }, [navigate]);\n\n  // 表单验证\n  const validateForm = () => {\n    const newErrors: {username?: string; password?: string} = {};\n    \n    if (!username || username.length < 3) {\n      newErrors.username = username ? '用户名至少3个字符' : '请输入用户名';\n    }\n    \n    if (!password || password.length < 6) {\n      newErrors.password = password ? '密码至少6个字符' : '请输入密码';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setLoading(true);\n    try {\n      const response = await authApi.login(username, password);\n      \n      if (response.code === 20000 && response.data?.admin_token) {\n        setStoredToken(response.data.admin_token);\n        showMessage.success('登录成功');\n        navigate('/admin', { replace: true });\n      } else {\n        showMessage.error(response.msg || '登录失败');\n      }\n    } catch (error) {\n      showMessage.error(error instanceof Error ? error.message : '登录失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\">\n      <Card className=\"w-full max-w-md shadow-2xl\">\n        <CardBody className=\"p-8\">\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">\n              管理后台\n            </h1>\n            <p className=\"text-gray-500\">Star Share Admin</p>\n          </div>\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div>\n              <label className=\"block mb-2 text-sm font-medium text-gray-700\">\n                用户名\n              </label>\n              <Input\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                placeholder=\"请输入用户名\"\n                size=\"lg\"\n                startContent={<User size={18} color=\"#9ca3af\" />}\n                autoComplete=\"username\"\n                isInvalid={!!errors.username}\n                errorMessage={errors.username}\n              />\n            </div>\n\n            <div>\n              <label className=\"block mb-2 text-sm font-medium text-gray-700\">\n                密码\n              </label>\n              <Input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"请输入密码\"\n                size=\"lg\"\n                startContent={<Lock size={18} color=\"#9ca3af\" />}\n                autoComplete=\"current-password\"\n                isInvalid={!!errors.password}\n                errorMessage={errors.password}\n              />\n            </div>\n\n            <Button\n              type=\"submit\"\n              size=\"lg\"\n              isLoading={loading}\n              disabled={loading}\n              className=\"w-full h-12 text-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 transition-colors\"\n              color=\"primary\"\n            >\n              {loading ? <Spinner size=\"sm\" color=\"white\" /> : '登录'}\n            </Button>\n          </form>\n\n          <div className=\"mt-6 text-center text-xs text-gray-500\">\n            © 2024 Star Share. All rights reserved.\n          </div>\n        </CardBody>\n      </Card>\n    </div>\n  );\n};\n\nexport default AdminLogin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}