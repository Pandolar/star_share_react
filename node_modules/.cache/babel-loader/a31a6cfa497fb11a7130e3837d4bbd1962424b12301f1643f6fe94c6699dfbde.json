{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,CardBody,Input,Button,Spinner}from'@heroui/react';import{Lock,User}from'lucide-react';import{useNavigate}from'react-router-dom';import{authApi}from'../../services/api';import{isAuthenticated,setStoredToken}from'../../config';import{showMessage}from'../../utils/toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminLogin=()=>{const[loading,setLoading]=useState(false);const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[errors,setErrors]=useState({});const navigate=useNavigate();// 如果已经登录，直接跳转到管理页面\nuseEffect(()=>{if(isAuthenticated()){navigate('/admin',{replace:true});}},[navigate]);// 表单验证\nconst validateForm=()=>{const newErrors={};if(!username||username.length<3){newErrors.username=username?'用户名至少3个字符':'请输入用户名';}if(!password||password.length<6){newErrors.password=password?'密码至少6个字符':'请输入密码';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}setLoading(true);try{var _response$data;const response=await authApi.login(username,password);if(response.code===20000&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.admin_token){setStoredToken(response.data.admin_token);showMessage.success('登录成功');navigate('/admin',{replace:true});}else{showMessage.error(response.msg||'登录失败');}}catch(error){showMessage.error(error instanceof Error?error.message:'登录失败');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{style:{minHeight:'100vh',display:'flex',alignItems:'center',justifyContent:'center',background:'linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%)'},children:/*#__PURE__*/_jsx(Card,{style:{width:'100%',maxWidth:'400px',boxShadow:'0 25px 50px -12px rgba(0, 0, 0, 0.25)'},children:/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginBottom:'32px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'24px',fontWeight:'bold',color:'#1f2937',marginBottom:'8px'},children:\"\\u7BA1\\u7406\\u540E\\u53F0\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#6b7280'},children:\"Star Share Admin\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:{display:'flex',flexDirection:'column',gap:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\u7528\\u6237\\u540D\"}),/*#__PURE__*/_jsx(Input,{value:username,onChange:e=>setUsername(e.target.value),placeholder:\"\\u8BF7\\u8F93\\u5165\\u7528\\u6237\\u540D\",size:\"lg\",startContent:/*#__PURE__*/_jsx(User,{size:18,color:\"#9ca3af\"}),autoComplete:\"username\",isInvalid:!!errors.username,errorMessage:errors.username})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\u5BC6\\u7801\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),placeholder:\"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",size:\"lg\",startContent:/*#__PURE__*/_jsx(Lock,{size:18,color:\"#9ca3af\"}),autoComplete:\"current-password\",isInvalid:!!errors.password,errorMessage:errors.password})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",size:\"lg\",isLoading:loading,disabled:loading,className:\"w-full h-12 text-lg font-semibold mt-2 bg-blue-600 text-white hover:bg-blue-700 transition-colors\",children:loading?/*#__PURE__*/_jsx(Spinner,{size:\"sm\",color:\"white\"}):'登录'})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'24px',textAlign:'center',fontSize:'12px',color:'#6b7280'},children:/*#__PURE__*/_jsx(\"div\",{children:\"\\xA9 2024 Star Share. All rights reserved.\"})})]})})});};export default AdminLogin;","map":{"version":3,"names":["React","useState","useEffect","Card","CardBody","Input","Button","Spinner","Lock","User","useNavigate","authApi","isAuthenticated","setStoredToken","showMessage","jsx","_jsx","jsxs","_jsxs","AdminLogin","loading","setLoading","username","setUsername","password","setPassword","errors","setErrors","navigate","replace","validateForm","newErrors","length","Object","keys","handleSubmit","e","preventDefault","_response$data","response","login","code","data","admin_token","success","error","msg","Error","message","style","minHeight","display","alignItems","justifyContent","background","children","width","maxWidth","boxShadow","textAlign","marginBottom","fontSize","fontWeight","color","onSubmit","flexDirection","gap","value","onChange","target","placeholder","size","startContent","autoComplete","isInvalid","errorMessage","type","isLoading","disabled","className","marginTop"],"sources":["/opt/dev/star_share/web/src/pages/admin/AdminLogin.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Card, CardBody, Input, Button, Spinner } from '@heroui/react';\nimport { Lock, User } from 'lucide-react';\nimport { useNavigate } from 'react-router-dom';\nimport { authApi } from '../../services/api';\nimport { isAuthenticated, setStoredToken } from '../../config';\n\nimport { showMessage } from '../../utils/toast';\n\nconst AdminLogin: React.FC = () => {\n  const [loading, setLoading] = useState(false);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errors, setErrors] = useState<{username?: string; password?: string}>({});\n  const navigate = useNavigate();\n\n  // 如果已经登录，直接跳转到管理页面\n  useEffect(() => {\n    if (isAuthenticated()) {\n      navigate('/admin', { replace: true });\n    }\n  }, [navigate]);\n\n  // 表单验证\n  const validateForm = () => {\n    const newErrors: {username?: string; password?: string} = {};\n    \n    if (!username || username.length < 3) {\n      newErrors.username = username ? '用户名至少3个字符' : '请输入用户名';\n    }\n    \n    if (!password || password.length < 6) {\n      newErrors.password = password ? '密码至少6个字符' : '请输入密码';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setLoading(true);\n    try {\n      const response = await authApi.login(username, password);\n      \n      if (response.code === 20000 && response.data?.admin_token) {\n        setStoredToken(response.data.admin_token);\n        showMessage.success('登录成功');\n        navigate('/admin', { replace: true });\n      } else {\n        showMessage.error(response.msg || '登录失败');\n      }\n    } catch (error) {\n      showMessage.error(error instanceof Error ? error.message : '登录失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div \n      style={{\n        minHeight: '100vh',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%)'\n      }}\n    >\n      <Card \n        style={{\n          width: '100%',\n          maxWidth: '400px',\n          boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)'\n        }}\n      >\n        <CardBody>\n          <div style={{ textAlign: 'center', marginBottom: '32px' }}>\n            <div style={{ \n              fontSize: '24px', \n              fontWeight: 'bold', \n              color: '#1f2937', \n              marginBottom: '8px' \n            }}>\n              管理后台\n            </div>\n            <div style={{ color: '#6b7280' }}>Star Share Admin</div>\n          </div>\n\n          <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\n            <div>\n              <label style={{ \n                display: 'block', \n                marginBottom: '8px', \n                fontSize: '14px', \n                fontWeight: '500', \n                color: '#374151' \n              }}>\n                用户名\n              </label>\n              <Input\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                placeholder=\"请输入用户名\"\n                size=\"lg\"\n                startContent={<User size={18} color=\"#9ca3af\" />}\n                autoComplete=\"username\"\n                isInvalid={!!errors.username}\n                errorMessage={errors.username}\n              />\n            </div>\n\n            <div>\n              <label style={{ \n                display: 'block', \n                marginBottom: '8px', \n                fontSize: '14px', \n                fontWeight: '500', \n                color: '#374151' \n              }}>\n                密码\n              </label>\n              <Input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"请输入密码\"\n                size=\"lg\"\n                startContent={<Lock size={18} color=\"#9ca3af\" />}\n                autoComplete=\"current-password\"\n                isInvalid={!!errors.password}\n                errorMessage={errors.password}\n              />\n            </div>\n\n            <Button\n              type=\"submit\"\n              size=\"lg\"\n              isLoading={loading}\n              disabled={loading}\n              className=\"w-full h-12 text-lg font-semibold mt-2 bg-blue-600 text-white hover:bg-blue-700 transition-colors\"\n            >\n              {loading ? <Spinner size=\"sm\" color=\"white\" /> : '登录'}\n            </Button>\n          </form>\n\n          <div style={{ \n            marginTop: '24px', \n            textAlign: 'center', \n            fontSize: '12px', \n            color: '#6b7280' \n          }}>\n            <div>© 2024 Star Share. All rights reserved.</div>\n          </div>\n        </CardBody>\n      </Card>\n    </div>\n  );\n};\n\nexport default AdminLogin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}